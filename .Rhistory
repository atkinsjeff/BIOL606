tinytex::install_tinytex()
library(ggplot2)
library(dplyr)
# Load the data
data(InsectSprays)
# Calculate means and standard errors by spray type
summary_data <- InsectSprays %>%
group_by(spray) %>%
summarize(
mean_count = mean(count),
se = sd(count) / sqrt(n()),
.groups = "drop"
)
# Create bar chart with error bars
x11()
ggplot(summary_data, aes(x = spray, y = mean_count, fill = spray)) +
geom_bar(stat = "identity", color = "black") +
geom_errorbar(aes(ymin = mean_count - se,
ymax = mean_count + se),
width = 0.3) +
labs(x = "Insecticide Spray Type",
y = "Mean Insect Count",
title = "Insect Counts by Spray Type") +
theme_bw() +
theme(legend.position = "none")
library(car)
install.packages("car")
library(car)
# Run ANOVA
anova_model <- aov(count ~ spray, data = InsectSprays)
# ANOVA table
cat("\n=== ANOVA Results ===\n")
summary(anova_model)
# Calculate effect size (eta-squared)
cat("\n=== Effect Size ===\n")
ss_total <- sum((InsectSprays$count - mean(InsectSprays$count))^2)
ss_spray <- sum(anova_model$effects[-1]^2)
eta_squared <- ss_spray / ss_total
cat("Eta-squared:", round(eta_squared, 3), "\n")
# Check assumptions
cat("\n=== Assumption Tests ===\n")
# Normality of residuals
cat("\nShapiro-Wilk Test for Normality:\n")
shapiro_test <- shapiro.test(residuals(anova_model))
print(shapiro_test)
# Homogeneity of variance
cat("\nLevene's Test for Homogeneity of Variance:\n")
levene_test <- leveneTest(count ~ spray, data = InsectSprays)
print(levene_test)
# Diagnostic plots
cat("\n=== Diagnostic Plots ===\n")
par(mfrow = c(2, 2))
plot(anova_model)
par(mfrow = c(1, 1))
# Post-hoc comparisons (Tukey HSD)
cat("\n=== Tukey HSD Post-hoc Comparisons ===\n")
tukey_results <- TukeyHSD(anova_model)
print(tukey_results)
# Visualize Tukey results
plot(tukey_results, las = 1, cex.axis = 0.7)
title("Tukey HSD: Pairwise Comparisons")
print(tukey_results)
library(ggplot2)
library(dplyr)
data(InsectSprays)
# Calculate summary data
summary_data <- InsectSprays %>%
group_by(spray) %>%
summarize(
mean_count = mean(count),
se = sd(count) / sqrt(n()),
.groups = "drop"
)
# Run ANOVA and Tukey
anova_model <- aov(count ~ spray, data = InsectSprays)
tukey_results <- TukeyHSD(anova_model)
# Function to determine significance vs control (spray A)
get_sig_vs_control <- function(spray_name, tukey_results) {
if (spray_name == "A") return("")  # Control
comparison_name <- paste(spray_name, "A", sep = "-")
p_value <- tukey_results$spray[comparison_name, "p adj"]
if (p_value < 0.001) return("***")
if (p_value < 0.01) return("**")
if (p_value < 0.05) return("*")
return("ns")
}
# Add significance symbols
summary_data$significance <- sapply(summary_data$spray,
get_sig_vs_control,
tukey_results = tukey_results)
# Create plot
x11()
ggplot(summary_data, aes(x = spray, y = mean_count, fill = spray)) +
geom_bar(stat = "identity", color = "black") +
geom_errorbar(aes(ymin = mean_count - se,
ymax = mean_count + se),
width = 0.3) +
geom_text(aes(label = significance, y = mean_count + se + 1.5),
size = 6, fontface = "bold") +
labs(x = "Insecticide Spray Type",
y = "Mean Insect Count",
title = "Insect Counts by Spray Type",
caption = "* p < 0.05, ** p < 0.01, *** p < 0.001 compared to spray A (Tukey HSD)") +
theme_bw() +
theme(legend.position = "none")
pca_result <- prcomp(iris[, 1:4], scale. = TRUE)
# Biplot
biplot(pca_result, scale = 0)
# With ggplot2
library(ggplot2)
library(ggfortify)
install.pacakges("ggfortify")
install.packges("ggfortify")
install.packages("ggfortify")
pca_result <- prcomp(iris[, 1:4], scale. = TRUE)
# Biplot
biplot(pca_result, scale = 0)
# With ggplot2
library(ggplot2)
library(ggfortify)
autoplot(pca_result, data = iris, colour = 'Species',
loadings = TRUE, loadings.label = TRUE,
loadings.label.size = 3) +
theme_bw()
pca_result <- rda(varechem, scale = TRUE)
library(vegan)
install.packages("vegan")
library(vegan)
data(varechem)
# PCA with vegan's rda function (same as prcomp for PCA)
pca_result <- rda(varechem, scale = TRUE)
# Biplot
biplot(pca_result, scaling = 2)
# Or with prcomp
pca_result <- prcomp(varechem, scale. = TRUE)
biplot(pca_result)
data(iris)
iris.pca <- prcomp (~ Sepal.Length + Sepal.Width + Petal.Length + Petal.Width,
data=iris,
scale. = TRUE)
summary(iris.pca)
iris.gg <-
ggbiplot(iris.pca, obs.scale = 1, var.scale = 1,
groups = iris$Species, point.size=2,
varname.size = 5,
varname.color = "black",
varname.adjust = 1.2,
ellipse = TRUE,
circle = TRUE) +
labs(fill = "Species", color = "Species") +
theme_minimal(base_size = 14) +
theme(legend.direction = 'horizontal', legend.position = 'top')
iris.pca
summary(iris.pca)
iris.gg <-
ggbiplot(iris.pca, obs.scale = 1, var.scale = 1,
groups = iris$Species, point.size=2,
varname.size = 5,
varname.color = "black",
varname.adjust = 1.2,
ellipse = TRUE,
circle = TRUE) +
labs(fill = "Species", color = "Species") +
theme_minimal(base_size = 14) +
theme(legend.direction = 'horizontal', legend.position = 'top')
library(ggbiplot)
install.packages("ggbiplot")
data(iris)
library(ggbiplot)
iris.pca <- prcomp (~ Sepal.Length + Sepal.Width + Petal.Length + Petal.Width,
data=iris,
scale. = TRUE)
summary(iris.pca)
iris.gg <-
ggbiplot(iris.pca, obs.scale = 1, var.scale = 1,
groups = iris$Species, point.size=2,
varname.size = 5,
varname.color = "black",
varname.adjust = 1.2,
ellipse = TRUE,
circle = TRUE) +
labs(fill = "Species", color = "Species") +
theme_minimal(base_size = 14) +
theme(legend.direction = 'horizontal', legend.position = 'top')
iris.gg
install.packages("ggdendro")
library(ggplot2)
library(ggdendro)
theme_set(theme_bw())
hc <- hclust(dist(USArrests), "ave")  #
head(USArrests)
?hclust
library(ggplot2)
library(ggdendro)
theme_set(theme_bw())
scaled_data <- scale(USArrests)
hc_ward <- hclust(dist(scaled_data), method="ward.D2")
plot(hc_ward, main="Dendrogram with Ward's Linkage",
xlab="States", ylab="Distance", hang=-1, cex=0.6)
ggdendrogram(hc_ward, rotate = TRUE, size = 2)
ggdendrogram(hc_ward, rotate = FALSE, size = 2)
ggdendrogram(hc_ward, rotate = TRUE, size = 5)
ggdendrogram(hc_ward, rotate = TRUE, size = 2)
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
---
title: "Pre-Test: Statistical Knowledge Assessment"
`r Sys.Date()`
Sys.Date()
knitr::opts_chunk$set(echo = TRUE)
data(iris)
library(ggbiplot)
data(iris)
library(ggplot2)
library(ggbiplot)
iris.pca <- prcomp (~ Sepal.Length + Sepal.Width + Petal.Length + Petal.Width,
data=iris,
scale. = TRUE)
ggbiplot(iris.pca, obs.scale = 1, var.scale = 1,
groups = iris$Species, point.size=2,
varname.size = 5,
varname.color = "black",
varname.adjust = 1.2,
ellipse = TRUE,
circle = TRUE) +
labs(fill = "Species", color = "Species") +
theme_minimal(base_size = 14) +
theme(legend.direction = 'horizontal', legend.position = 'top')
library(ggplot2)
library(ggdendro)
theme_set(theme_bw())
scaled_data <- scale(USArrests)
hc_ward <- hclust(dist(scaled_data), method="ward.D2")
ggdendrogram(hc_ward, rotate = TRUE, size = 2)
knitr::opts_chunk$set(echo = TRUE)
```
knitr::opts_chunk$set(echo = TRUE)
```
---
title: "Pre-Test: Statistical Knowledge Assessment"
update.packages("lmitr")
update.packages("knitr")
require(palmerpenguins)
require(ggplot2)
require(RColorBrewer)
##### CUSTOM PLOT THEME
try_theme <- function() {
theme(
# add border 1)
panel.border = element_rect(colour = "black", fill = NA, size = 0.5),
# color background 2)
panel.background = element_rect(fill = "white"),
# modify grid 3)
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.text = element_text(size = 12, colour = "black", family = "Times New Roman"),
axis.title = element_text(size = 12, colour = "black", family = "Times New Roman"),
axis.ticks = element_line(colour = "black"),
axis.ticks.length=unit(-0.1, "cm"),
# legend at the bottom 6)
# legend.position = "bottom",
strip.text.x = element_text(size=12, color="black",  family = "Times New Roman"),
strip.text.y = element_text(size=10, color="black",  family = "Times New Roman"),
strip.background = element_blank()
)
}
lm_eqn <- function(df){
m <- lm(flipper_length_mm ~ body_mass_g, data = pen);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(unname(coef(m)[1]), digits = 2),
b = format(unname(coef(m)[2]), digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
x11(height = 6, width = 6)
ggplot(pen, aes(x = body_mass_g, y = flipper_length_mm))+
geom_point(size = 3, alpha = 0.9)+
try_theme()+
theme(legend.position = c(0.1, 0.9), legend.title = element_blank())+
ylab("Flipper Length [mm]")+
xlab("Body Mass [g]")+
stat_smooth(method = "lm", se = FALSE, size = 1.25)+
geom_text(x = 3100, y = 220, label = lm_eqn(pen), parse = TRUE)
pen <- data.frame(penguins)
x11(height = 6, width = 6)
ggplot(pen, aes(x = body_mass_g, y = flipper_length_mm))+
geom_point(size = 3, alpha = 0.9)+
try_theme()+
theme(legend.position = c(0.1, 0.9), legend.title = element_blank())+
ylab("Flipper Length [mm]")+
xlab("Body Mass [g]")+
stat_smooth(method = "lm", se = FALSE, size = 1.25)+
geom_text(x = 3100, y = 220, label = lm_eqn(pen), parse = TRUE)
x11(height = 6, width = 6)
ggplot(pen, aes(x = body_mass_g, y = flipper_length_mm))+
geom_point(size = 3, alpha = 0.9)+
try_theme()+
theme(legend.position = c(0.1, 0.9), legend.title = element_blank())+
ylab("Flipper Length [mm]")+
xlab("Body Mass [g]")+
stat_smooth(method = "lm", se = FALSE, size = 1.25)+
geom_text(x = 3200, y = 220, label = lm_eqn(pen), parse = TRUE)
x11(height = 6, width = 6)
ggplot(pen, aes(x = body_mass_g, y = flipper_length_mm))+
geom_point(size = 3, alpha = 0.9)+
try_theme()+
theme(legend.position = c(0.1, 0.9), legend.title = element_blank())+
ylab("Flipper Length [mm]")+
xlab("Body Mass [g]")+
stat_smooth(method = "lm", se = FALSE, size = 1.25)+
geom_text(x = 3300, y = 220, label = lm_eqn(pen), parse = TRUE)
x11(height = 6, width = 6)
ggplot(pen, aes(x = body_mass_g, y = flipper_length_mm))+
geom_point(size = 3, alpha = 0.9)+
try_theme()+
theme(legend.position = c(0.1, 0.9), legend.title = element_blank())+
ylab("Flipper Length [mm]")+
xlab("Body Mass [g]")+
stat_smooth(method = "lm", se = FALSE, size = 1.25)+
geom_text(x = 3350, y = 220, label = lm_eqn(pen), parse = TRUE)
x11(height = 6, width = 6)
ggplot(pen, aes(x = body_mass_g, y = flipper_length_mm))+
geom_point(size = 3, alpha = 0.9)+
try_theme()+
theme(legend.position = c(0.1, 0.9), legend.title = element_blank())+
ylab("Flipper Length [mm]")+
xlab("Body Mass [g]")+
stat_smooth(method = "lm", se = FALSE, size = 1.25)
?cor()
cor(body_mass_g, flipper_length_mm, data = pen)
cor(pen$body_mass_g, pen$flipper_length_mm)
cor(pen$body_mass_g, pen$flipper_length_mm, na.rm = TRUE)
cor(pen$body_mass_g, pen$flipper_length_mm, use = "complete.obs", method = "pearson"))
cor(pen$body_mass_g, pen$flipper_length_mm, use = "complete.obs", method = "pearson")
summary(lm(flipper_length_mm ~ body_mass_g, data = pen))
